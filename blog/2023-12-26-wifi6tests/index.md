---
slug: wifi6
title: Замеры скоростей WiFi6
authors: dmn
tags: [wifi6, dok]
---

> Тут скоро будет статья и много картинок

## Объекты эксперимента

### WiFi Роутер NetGear ORBI RBRE960

Куплен был по следующим причинам:
- Поддержка Wifi6 (именно 6ГГц диапазон) 
- Наличие порта 10Гбит (почемуто WAN)
- Наличие порта 2.5гбит (всего один порт LAN)

Порты распределены загадочно, но наличие портов больше 1Гбит дает надежду на высокие скорости. 

![Alt text](img-orbi/orbi-1.jpg)

![Alt text](img-orbi/orbi-2-1.jpg)

### Ноубук с картой Intel AX210

Была куплена карта Intel AX210 (2,4G/5G/6G) с поддержкой 6Ггц изъята из "компьютерного" корпуса и засунута в ноутбук HP.

![Alt text](img-orbi/intel-ax-210.jpg)

### Компьютер с картой Intel AX210

Карта была куплена на AliExpress и как есть вставлена в материнскую плату компьютера.

![Alt text](img-orbi/intel-ax-210-comp.jpg)

### Карта Ethernet 2.5Гбит

Для тестов "на проводе" задействовали карту 
в USB3.0

![Alt text](img-orbi/2.5gbps-net.jpg)

### Ноутбук с картой wifi5 (5.2Ггц)

Стандартная wifi карточка Realtek в ноутбуке HP

## Методика тестирования 

Использовались три теста

1. iperf3 в один поток
2. iperf3 в 8 потоков
3. Скачивание файла 4Гбайт по протоколу http (программой wget)

## Первый тест "Разминка". WiFi5.

Для начала был проведен мини тест на WiFi5 (5.2ГГц), который сразу показал очень низкую скорость. Надо признаться, что эфир на 5Ггц у нас в БЦ довольно захламлен, оптимизаций каналов не проводилось, потому что основной интерес лежал в области WiFi6.

![Alt text](img-wifi5/schm1.jpg)

### Результаты

Вывод команды iperf3 один поток и 8 потоков

![Alt text](img-wifi5/results1.jpg)

Итак мы получаем "скачущий" результат от 263Мбит\с
до 451Мбит\с. 

Так как нас интересуют скорости больше 1Гбит, было решено время на WiFi больше не тратить. Скоростей в этом диапазоне нет, может быть можно "выжать" больше, но нас интересует более высокоскоростной диапазон 6.2Ггц.

## Тест "Проверим кабель"

Для того, чтобы убедиться что мы измеряем не кабельное соединение,
а беспроводное необходимо сначала проверить скорость по Ethernet. 

Была собрана нехитрая схема роутинга через NetGear

![Alt text](img-cable/schm1.jpg)

### Результаты

iperf один поток

![](img-cable/iperf1-wired.jpg)

>Видим результаты больше 2Гбит\с

iperf 8 потоков

![](img-cable/iperf8-wired.jpg)

>Видим результаты, близкие к возможностям карты 2.5Гбит\с.

- Перелача большого файла (wget)

![](img-cable/wget-wired.jpg)

>Отметим, что результаты слабые (скорость передачи файла примерно 1.5Гбит\с),
возможно упираемся в возможности роутинга NetGear. Проверим позже.

## Тест WiFi6 (компьютер) - Ethernet 2.5Gb (локалка)

Нехитрая схемка.

>Ноубук (Ubuntu 22.04) и Компьютер (Open suse) под управлением Linux с свежими ядрами.

![Alt text](img-wifi6-comp/schm1.jpg)

Убедимся что у нас таки WiFi6

![Alt text](img-wifi6-comp/2023-12-27_00-54.jpg)

### Результаты

iperf3 один поток

![Alt text](img-wifi6-comp/iperf1-compwifi6.jpg)

iperf3 8 потоков

![Alt text](img-wifi6-comp/iperf8-compwifi6.jpg)

Итак **наконец то** мы видим приличные скорости, но не те, что нам обещали конечно.

>Результат **1,41 - 1,76 Гбит\с** гораздо ниже заявленного >рекламного, но гораздо лучше WiFi на 5Ггц. Мы также видим, что мы не упираемся в локальную скорость по кабелю 2.5Гб и даже не приближаемся к ней.

Вытянем длинный файл (4Гб) с ноутбука с Etehernet через WiFi6.
Чтобы не тормозить записью на носитель пишем в `/dev/null`

![Alt text](img-wifi6-comp/wget-compwifi6.jpg)

Получаем 122Мб\с что соответствует 122*8= **976Кбайт\с**. Понятно, что часть трафика ушла на заголовки http и tcp. Запомним этот результат. 

## Тест WiFi6 (ноутбук) - Ethernet 2.5Gb (локалка)

Для чистоты эксперимента возьмем другую карту WiFi6 (которую мы "встроили в Ноутбук)

Нехитрая схема. Ноутбук у нас под свежей версией ArchLinux.

Какие отличия от предыдущей схемы

- На карте wifi нет радиатора, она вставлена в слот M2
- Другой Linux (а вдруг)

![Alt text](img-wifi6-notebook/shm1.jpg)

Убедимся что мы в WiFi6

![Alt text](img-wifi6-notebook/cardparams.jpg)

### Результаты

iperf3 1 поток

![Alt text](img-wifi6-notebook/iperf3-1-wifi6-notebook.jpg)

>Мы видим падение скорости 1.49Гбит - 0,818Гбит (может нагрелась карточка), но далее идет возвращение к 1,57Гбит. 

iperf3 8 потоков 

![Alt text](img-wifi6-notebook/iperf3-8-wifi6-notebook.jpg)

>Мы вдруг видим рекорд скорости - **1,95Гбит** и лучшую в среднем скорость, чем с компьютера. И пока это рекорд. 

Скачаем большой файл

>забыли сделать картинку, сделаем

## Тест WiFi6 - WiFi6

Теперь проведем интересный тест, когда оба девайса на Wifi6.

![Alt text](img-wifi6-wifi6/schm1-w6-w6.jpg)

На обоих хостах был запущен iperf3 в режиме клиента и сервера одновременно. 

![Alt text](img-wifi6-wifi6/w6-w6-iperf1-1.jpg)

>Видно,как отчаянно точки "сражаются" за канал. Видно, что проседает больше одна точка, чем вторая (возможно процессор мощнее). Видно, что агрегации нет, точки делят всю ту же полосу 1,5-1,9Гбит. 

>Также в последней сточке получилось рекордное "суммарное", но моя гипотеза состоит в том, что один уже закончил тест и второй "хапнул" все. Однако требует более длительного теста, чтобы это подтвердить. 

Прогоним большой фал одновременно с двух хостов

![Alt text](img-wifi6-wifi6/w6-w6-wget-1.jpg)

>Здесь более четко видно, что полоса поделена между хостами в не очень равных долях.










<!--truncate-->